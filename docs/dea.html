<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="zh-Hans" xml:lang="zh-Hans"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.42">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>11&nbsp; 数据包络分析 – mathmodels 包使用手册</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./inequality.html" rel="next">
<link href="./fuzzy-eval.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting-2f5df379a58b258e96c21c0638c20c03.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap-8da5b4427184b79ecddefad3d342027e.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "没有结果",
    "search-matching-documents-text": "匹配的文档",
    "search-copy-link-title": "复制搜索链接",
    "search-hide-matches-text": "隐藏其它匹配结果",
    "search-more-match-text": "更多匹配结果",
    "search-more-matches-text": "更多匹配结果",
    "search-clear-button-title": "清除",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "取消",
    "search-submit-button-title": "提交",
    "search-label": "搜索"
  }
}</script><script>
MathJax ={
  tex: {
    macros: {
      bm: ["{\\boldsymbol #1}",1],
    }
  }
};
</script><script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="展开或折叠侧边栏导航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./comp-eval.html">评价类算法</a></li><li class="breadcrumb-item"><a href="./dea.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">数据包络分析</span></a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="展开或折叠侧边栏导航" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="搜索" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">mathmodels 包使用手册</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="搜索"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">前言</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./comp-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">评价类算法</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="展开或折叠此栏">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./preprocessing.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">指标数据预处理</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./ahp-weight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">层次分析法</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./entropy-weight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">熵权法</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./critic-weight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">CRITIC 法</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./pca-weight.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">主成分赋权法</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./combine-weights.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">主客观组合赋权</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./topsis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">TOPSIS</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./grey-relational.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">灰色关联分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./rank-sum-ratio.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">秩和比法</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./fuzzy-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">模糊综合评价</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./dea.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">数据包络分析</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./inequality.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">不平等度量</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./regional-economics.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">13</span>&nbsp; <span class="chapter-title">区域经济</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./system-eval.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">14</span>&nbsp; <span class="chapter-title">系统评价</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./references.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">参考文献</span></a>
  </div>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">目录</h2>
   
  <ul>
<li><a href="#dea-%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5" id="toc-dea-相关概念" class="nav-link active" data-scroll-target="#dea-%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5"><span class="header-section-number">11.1</span> DEA 相关概念</a></li>
  <li>
<a href="#%E5%B8%B8%E7%94%A8-dea-%E6%A8%A1%E5%9E%8B" id="toc-常用-dea-模型" class="nav-link" data-scroll-target="#%E5%B8%B8%E7%94%A8-dea-%E6%A8%A1%E5%9E%8B"><span class="header-section-number">11.2</span> 常用 DEA 模型</a>
  <ul class="collapse">
<li><a href="#ccr%E6%A8%A1%E5%9E%8B-%E8%A7%84%E6%A8%A1%E6%94%B6%E7%9B%8A%E4%B8%8D%E5%8F%98%E5%81%87%E8%AE%BE%E4%B8%8B%E7%9A%84%E5%BE%84%E5%90%91-dea-%E6%A8%A1%E5%9E%8B" id="toc-ccr模型-规模收益不变假设下的径向-dea-模型" class="nav-link" data-scroll-target="#ccr%E6%A8%A1%E5%9E%8B-%E8%A7%84%E6%A8%A1%E6%94%B6%E7%9B%8A%E4%B8%8D%E5%8F%98%E5%81%87%E8%AE%BE%E4%B8%8B%E7%9A%84%E5%BE%84%E5%90%91-dea-%E6%A8%A1%E5%9E%8B"><span class="header-section-number">11.2.1</span> CCR模型 （规模收益不变假设下的径向 DEA 模型）</a></li>
  <li><a href="#bcc%E6%A8%A1%E5%9E%8B%E8%A7%84%E6%A8%A1%E6%94%B6%E7%9B%8A%E5%8F%AF%E5%8F%98%E5%81%87%E8%AE%BE%E4%B8%8B%E7%9A%84%E5%BE%84%E5%90%91-dea-%E6%A8%A1%E5%9E%8B" id="toc-bcc模型规模收益可变假设下的径向-dea-模型" class="nav-link" data-scroll-target="#bcc%E6%A8%A1%E5%9E%8B%E8%A7%84%E6%A8%A1%E6%94%B6%E7%9B%8A%E5%8F%AF%E5%8F%98%E5%81%87%E8%AE%BE%E4%B8%8B%E7%9A%84%E5%BE%84%E5%90%91-dea-%E6%A8%A1%E5%9E%8B"><span class="header-section-number">11.2.2</span> BCC模型（规模收益可变假设下的径向 DEA 模型）</a></li>
  <li><a href="#%E5%B8%A6%E9%9D%9E%E6%9C%9F%E6%9C%9B%E4%BA%A7%E5%87%BA%E7%9A%84-sbm-%E6%A8%A1%E5%9E%8B" id="toc-带非期望产出的-sbm-模型" class="nav-link" data-scroll-target="#%E5%B8%A6%E9%9D%9E%E6%9C%9F%E6%9C%9B%E4%BA%A7%E5%87%BA%E7%9A%84-sbm-%E6%A8%A1%E5%9E%8B"><span class="header-section-number">11.2.3</span> 带非期望产出的 SBM 模型</a></li>
  <li><a href="#%E8%B6%85%E6%95%88%E7%8E%87%E6%A8%A1%E5%9E%8B" id="toc-超效率模型" class="nav-link" data-scroll-target="#%E8%B6%85%E6%95%88%E7%8E%87%E6%A8%A1%E5%9E%8B"><span class="header-section-number">11.2.4</span> 超效率模型</a></li>
  <li><a href="#malmquist-%E6%8C%87%E6%95%B0" id="toc-malmquist-指数" class="nav-link" data-scroll-target="#malmquist-%E6%8C%87%E6%95%B0"><span class="header-section-number">11.2.5</span> Malmquist 指数</a></li>
  </ul>
</li>
  <li><a href="#dea-%E6%A1%88%E4%BE%8B" id="toc-dea-案例" class="nav-link" data-scroll-target="#dea-%E6%A1%88%E4%BE%8B"><span class="header-section-number">11.3</span> DEA 案例</a></li>
  <li><a href="#dea-malmquist-%E6%A1%88%E4%BE%8B" id="toc-dea-malmquist-案例" class="nav-link" data-scroll-target="#dea-malmquist-%E6%A1%88%E4%BE%8B"><span class="header-section-number">11.4</span> DEA-malmquist 案例</a></li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./comp-eval.html">评价类算法</a></li><li class="breadcrumb-item"><a href="./dea.html"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">数据包络分析</span></a></li></ol></nav><div class="quarto-title">
<h1 class="title"><span id="sec-dea" class="quarto-section-identifier"><span class="chapter-number">11</span>&nbsp; <span class="chapter-title">数据包络分析</span></span></h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header><p><strong>数据包络分析（DEA）</strong>，是一种基于线性规划的非参数评估方法。它通过构建相对效率评价模型，对多个具有多投入、多产出特征的决策单元（DMU）进行绩效评估和效率排序。DEA 的核心优势在于，它能够根据每个决策单元自身的投入和产出数据，自动优化其权重配置。这种方法无需事先设定固定的权重，从而能够更客观、真实地识别出对每个决策单元最有利的评价标准，准确反映其个体特征和实际运行效率。</p>
<p>DEA 已被广泛应用于生产管理、行政绩效评估等诸多领域。它不仅可以用于评估不同方案的相对有效性，例如投资项目的效益比较，还可以在决策前进行效果预测，或在政策实施后评估其成效。通过 DEA 的辅助，决策者能够更科学地制定策略，提升管理和决策的精准性。</p>
<p><strong>DEA 优点：</strong></p>
<ol type="1">
<li>多指标处理能力：DEA 擅长处理多输入和多输出指标的综合评价问题，适用于复杂系统的效率评估。</li>
<li>无需无量纲化：DEA 不对数据进行无量纲化处理，因为其效率指标的计算与输入输出数据的量纲无关。</li>
<li>客观性强：DEA 无需事先设定权重，而是根据实际数据计算最优权重，减少了主观因素的干扰，提高了评估的客观性。</li>
<li>灵活的关系建模：DEA 假定输入和输出之间存在某种联系，但不需要明确表达这种关系的具体形式，从而增加了模型的灵活性。</li>
</ol>
<p><strong>DEA 缺点：</strong></p>
<ol type="1">
<li>数据依赖性：DEA 的效率评估结果依赖于所收集的数据，最优效率仅在当前样本范围内有效。</li>
<li>技术有效单元的局限性：DEA 无法对技术有效单元进行进一步比较，且未考虑系统中的随机因素，可能导致在存在异常点时评估结果失真。</li>
</ol>
<section id="dea-相关概念" class="level2" data-number="11.1"><h2 data-number="11.1" class="anchored" data-anchor-id="dea-相关概念">
<span class="header-section-number">11.1</span> DEA 相关概念</h2>
<p>设有 <span class="math inline">\(n\)</span> 个部门或决策单元 （DMU），每个决策单元有 <span class="math inline">\(m\)</span> 个输入变量和 <span class="math inline">\(q\)</span> 个输出变量： <span class="math display">\[
\begin{array}{ccccccccc}
&amp;&amp;&amp; m~\text{个投入} &amp;&amp;&amp;&amp; q~\text{个产出} \\
\text{DMU/指标}~ &amp; ~x_1 &amp; x_2 &amp; \cdots &amp; x_m~ &amp; ~y_1 &amp; y_2 &amp; \cdots &amp; y_q \\
1~ &amp; ~x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1m}~ &amp; ~y_{11} &amp; y_{12} &amp; \cdots &amp; y_{1q} \\
2~ &amp; ~x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2m}~ &amp; ~y_{21} &amp; y_{22} &amp; \cdots &amp; y_{2q} \\
\vdots~ &amp; ~\vdots &amp; \vdots &amp; \ddots &amp; \vdots~ &amp; ~\vdots &amp; \vdots &amp; \ddots &amp; \vdots \\
n~ &amp; ~x_{n1} &amp; x_{n2} &amp; \cdots &amp; x_{nm}~ &amp; ~y_{n1} &amp; y_{n2} &amp; \cdots &amp; y_{nq} \\
&amp; \uparrow &amp; \uparrow &amp; \cdots &amp; \uparrow~ &amp; ~\uparrow &amp; \uparrow &amp; \cdots &amp; \uparrow \\
\text{权重}~ &amp; ~v_1 &amp; v_2 &amp; \cdots &amp; v_m~ &amp; ~ u_1 &amp; u_2 &amp; \cdots &amp; u_m
\end{array}
\]</span> 用 <span class="math inline">\(i=1,\cdots,n\)</span> 表示决策单元的索引；<span class="math inline">\(j=1,\cdots,m\)</span> 表示投入指标的索引； <span class="math inline">\(r=1,\cdots,q\)</span> 表示产出指标的索引。</p>
<p>改用向量形式表示，记 <span class="math display">\[
X_i=[x_{i1},x_{i2},\cdots,x_{im}],\quad Y_i=[y_{i1},y_{i2},\cdots,y_{iq}],\quad i=1,\cdots,n
\]</span> <span class="math display">\[
v = [\nu_1,\cdots,\nu_m],\quad u =[u_1,\cdots,u_q]
\]</span> 则 <span class="math inline">\(X_i,Y_i\)</span> 分别为第 <span class="math inline">\(i\)</span> 个决策单元的输入向量、输出向量；<span class="math inline">\(v,u\)</span> 分别为输入权重、输出权重。</p>
<p>DEA 评价的是技术效率，是指一个决策单元的生产过程达到本行业技术水平的程度。一般来说，技术效率可以使用产出和投入的比例衡量，但这种衡量方式一般仅适用于单投入单产出的情形。对于 <span class="math inline">\(m\)</span> 个投入和 <span class="math inline">\(q\)</span> 个产出，则第 <span class="math inline">\(k\)</span> 个决策单元的技术效率，可以用加权方式确定其综合的投入产出来刻画： <span class="math display">\[
h_k=\frac{\sum_{r=1}^qu_ry_{kr}}{\sum_{j=1}^m\nu_jx_{kj}}
\]</span> <strong>关于投入与产出导向：</strong></p>
<p>在径向 DEA 中，无效率往往是通过投入和产出的等比例变化定义的，因此既可以在给定投入的情况下最大化产出（产出导向），也可以在给定产出的情况下最小化投入（投入导向）。</p>
<p>对于不同的规模收益假设，不同导向的效率分析结果可能存在一定差异。对于规模收益不变的模型（CRS），两种导向的效率结果是一样的；而对于可变规模收益模型（VRS）中，二者是不同的。</p>
<p>在实践中，投入和产出导向的选择没有明确的要求，实际选择时最好是根据具体生产活动的实际，看是投入倾向于固定不变还是产出倾向于固定不变。</p>
<p><strong>DEA 模型的编程实现：</strong></p>
<p>R 语言有 deaR 包等可以实现 DEA 模型。</p>
<p>手动编程实现的话，因为本质上就是求解线性规划问题，在模型公式确定后，其编程过程可遵循如下步骤：</p>
<ol type="1">
<li>确定参数列向量；</li>
<li>将模型表示为线性规划标准形式；</li>
<li>改成用矩阵语言表示，梳理出各矩阵、向量；</li>
<li>调用线性规划求解器进行求解。</li>
</ol></section><section id="常用-dea-模型" class="level2" data-number="11.2"><h2 data-number="11.2" class="anchored" data-anchor-id="常用-dea-模型">
<span class="header-section-number">11.2</span> 常用 DEA 模型</h2>
<section id="ccr模型-规模收益不变假设下的径向-dea-模型" class="level3" data-number="11.2.1"><h3 data-number="11.2.1" class="anchored" data-anchor-id="ccr模型-规模收益不变假设下的径向-dea-模型">
<span class="header-section-number">11.2.1</span> CCR模型 （规模收益不变假设下的径向 DEA 模型）</h3>
<section id="投入导向的-ccr-模型" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="投入导向的-ccr-模型">(1) 投入导向的 CCR 模型</h4>
<p>在给定投入的条件下最大化产出。将前面加权方式的投入产出技术效率，再将其范围限制为 <span class="math inline">\([0,1]\)</span>，则得到投入导向的 CCR 模型：对每个决策单元 <span class="math inline">\(k\)</span>， <span class="math display">\[
\begin{aligned}
&amp;\max\frac{\sum_{r=1}^qu_ry_{kr}}{\sum_{j=1}^m v_jx_{kj}}\\
\mathbf{s.t.~~}&amp;\frac{\sum_{r=1}^qu_ry_{kr}}{\sum_{j=1}^m v_jx_{kj}}\leq1\\
&amp; v_j\geq0,u_r\geq0,\quad j=1,\cdots,m;\;r=1,\cdots q
\end{aligned}
\]</span></p>
<p>通过 Charnes-Cooper 变换线性化转化为线性规划：对每个决策单元 <span class="math inline">\(k\)</span>， <span class="math display">\[
\begin{aligned}&amp;\max\sum_{r=1}^q\mu_ry_{kr}\\\mathbf{s.t.~~}&amp;\sum_{r=1}^q\mu_ry_{kr}-\sum_{j=1}^m \nu_jx_{kj}\leq0\\&amp;\sum_{j=1}^m \nu_jx_{kj}=1\\&amp;\mu_r\geq0, \nu_j\geq0,\quad j=1,\cdots,m; \; r=1,\cdots q\end{aligned}
\]</span></p>
<p>上述问题的对偶形式为（对偶模型的决策变量中包含效率值）： 对每个决策单元 <span class="math inline">\(k\)</span> <span class="math display">\[
\begin{aligned}&amp;\min\theta\\\mathrm{s.t.~~}&amp;\sum_{i=1}^n\lambda_ix_{ij}\leq\theta x_{kj}\\&amp;\sum_{i=1}^n\lambda_iy_{ir}\geq y_{kr}\\&amp;\lambda_i\geq0,\quad j=1,\cdots,m;\;r=1,\cdots q\end{aligned}
\]</span></p>
<p>该对偶模型中，<span class="math inline">\(\lambda_i,i=1,\cdots,n\)</span> 表示 DMU 的线性组合系数，参数 <span class="math inline">\(\theta\)</span> 的最优解 <span class="math inline">\(\theta^*\)</span> 即为效率值，其范围落在 <span class="math inline">\([0,1]\)</span>。</p>
<p>该模型的含义相当于用加权方法构造出一个不存在的 DMU，其投入不大于待评价的 DMU，产出不小于待评价的 DMU，即 <span class="math display">\[
x=\sum_{i=1}^n\lambda_ix_{ij},\quad y=\sum_{i=1}^n\lambda_ix_{ir}
\]</span></p>
<p>为了便于求解，进一步改写为矩阵形式： <span class="math display">\[
\begin{aligned}
&amp;\min\left[0,\cdots,0,1\right]\left[\lambda_1,\cdots,\lambda_n,\theta\right]^T\\
\mathbf{s.t.}&amp;\begin{bmatrix}x_{11}&amp;x_{21}&amp;\cdots&amp;x_{n1}&amp;-x_{i1}\\x_{12}&amp;x_{22}&amp;\cdots&amp;x_{n2}&amp;-x_{i2}\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots\\
x_{1m}&amp;x_{2m}&amp;\cdots&amp;x_{nm}&amp;-x_{im}\end{bmatrix}\begin{bmatrix}\lambda_1\\
\vdots\\
\lambda_n\\
\theta\end{bmatrix}\leqslant\begin{bmatrix}0\\
0\\
\vdots\\
0\end{bmatrix}\\
&amp;\begin{bmatrix}-y_{11}&amp;-y_{21}&amp;\cdots&amp;-y_{n1}&amp;0\\
-y_{12}&amp;-y_{22}&amp;\cdots&amp;-y_{n2}&amp;0\\
\vdots&amp;\vdots&amp;\ddots&amp;\vdots&amp;\vdots\\
-y_{1q}&amp;-y_{2q}&amp;\cdots&amp;-y_{nq}&amp;0
\end{bmatrix}
\begin{bmatrix}
\lambda_1\\
\vdots\\
\lambda_n\\
\theta
\end{bmatrix}
\leqslant\begin{bmatrix}-y_{i1}\\
-y_{i2}\\
\vdots\\
-y_{iq}
\end{bmatrix}
\end{aligned}
\]</span></p>
<p>注意，模型的决策变量向量为 <span class="math inline">\([\lambda_{1}, \cdots, \lambda_{n}, \theta]^T\)</span>；两个系数矩阵的主体部分都是原始指标数据的转置，约束条件可以对应地按分块矩阵合并来写： <span class="math display">\[
\mathrm{s.t.}\quad \begin{bmatrix} X’\\ -Y’ \end{bmatrix}_{2\times1}\mathrm{\lambda}_{1\times1}\leqslant \begin{bmatrix}0\\-y’\end{bmatrix}_{2\times1}
\]</span></p>
</section><section id="产出导向的-ccr-模型" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="产出导向的-ccr-模型">(2) 产出导向的 CCR 模型</h4>
<p>在给定产出条件下最小化投入，具体推导过程略，只列出最终的对偶模型：对每个决策单元 <span class="math inline">\(k\)</span>， <span class="math display">\[
\begin{aligned}&amp;\max\phi\\\mathbf{s.t.~~}&amp;\sum_{i=1}^n\lambda_ix_{ij}\leq x_{kj}\\&amp;\sum_{i=1}^n\lambda_iy_{ir}\geq\phi y_{kr}\\&amp;\lambda_i\geq0,\quad j=1,\cdots,m;\;r=1,\cdots q\end{aligned}
\]</span></p>
<p>该模型的效率为 <span class="math inline">\(1 / \phi\)</span>。</p>
</section></section><section id="bcc模型规模收益可变假设下的径向-dea-模型" class="level3" data-number="11.2.2"><h3 data-number="11.2.2" class="anchored" data-anchor-id="bcc模型规模收益可变假设下的径向-dea-模型">
<span class="header-section-number">11.2.2</span> BCC模型（规模收益可变假设下的径向 DEA 模型）</h3>
<p>在 DEA 模型中，对规模收益（RTS）的设定决定了前沿的形状，CCR 模型是假设规模收益不变（CRS），即模型中的 <span class="math inline">\(\mathbf{\lambda}\)</span> 满足 <span class="math inline">\(\mathbf{\lambda} &gt; 0\)</span>，此时生产可能集（DEA 技术集）为以 OB 射线为前沿面的集合：</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="figs/crs.png" class="img-fluid figure-img" style="width:70.0%"></p>
<figcaption>CRS 假设下的生产可能集</figcaption></figure>
</div>
</div>
</div>
<p>但在实际生产过程中，生产技术的规模收益并非 CRS，若采用 CRS 假设（CCR模型），得出的技术效率并非完全是纯技术效率，而是包含了规模效率成分的综合效率。</p>
<p>一般来说，生产技术的规模收益要先后经历规模收益递增（IRS）、规模收益不变（CRS）、规模收益递减（DRS）三个阶段。</p>
<p>如果无法确定研究样本处于哪个阶段，则评价技术效率时应选择规模收益可变（VRS）模型，即模型中的 <span class="math inline">\(\mathbf{\lambda}\)</span> 满足 <span class="math inline">\(\sum \mathbf{\lambda} = 1\)</span>，此时生产可能集（DEA 技术集）为以线段 ABCD 以及 AD 往坐标轴的垂线为前沿（凸组合）：</p>
<div class="cell">
<div class="cell-output-display">
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="figs/vrs.png" class="img-fluid figure-img" style="width:80.0%"></p>
<figcaption>VRS 假设下生产可能集</figcaption></figure>
</div>
</div>
</div>
<p>VRS 模型得出的技术效率是纯技术效率。</p>
<p>BCC 模型即规模收益可变（VRS）假设下的径向 DEA 模型，与 CCR 模型的区别就是增加了等式约束 <span class="math inline">\(\sum \mathbf{\lambda} = 1\)</span>。</p>
<p><strong>投入导向的 BCC（对偶）模型</strong>： 对每个决策单元 <span class="math inline">\(k\)</span>， <span class="math display">\[
\begin{aligned}&amp;\min\theta\\\mathbf{s.t.~~}&amp;\sum_{i=1}^n\lambda_ix_{ij}\leq\theta x_{kj}\\&amp;\sum_{i=1}^n\lambda_iy_{ir}\geq y_{kr}\\&amp;\sum_{i=1}^n\lambda_i=1\\&amp;\lambda_i\geq0,\quad j=1,\cdots,m;\;r=1,\cdots q\end{aligned}
\]</span></p>
<p><strong>产出导向的 BCC（对偶）模型</strong>： 对每个决策单元 <span class="math inline">\(k\)</span>， <span class="math display">\[
\begin{aligned}&amp;\max\phi\\\mathbf{s.t.}&amp;\sum_{i=1}^n\lambda_ix_{ij}\leq x_{kj}\\&amp;\sum_{i=1}^n\lambda_iy_{ir}\geq\phi y_{kr}\\&amp;\sum_{i=1}^n\lambda_i=1\\&amp;\lambda_i\geq0,\quad j=1,\cdots,m;\; r=1,\cdots q\end{aligned}
\]</span></p>
</section><section id="带非期望产出的-sbm-模型" class="level3" data-number="11.2.3"><h3 data-number="11.2.3" class="anchored" data-anchor-id="带非期望产出的-sbm-模型">
<span class="header-section-number">11.2.3</span> 带非期望产出的 SBM 模型</h3>
<p>在径向模型中，效率改善主要指的是投入或产出的等比例线性放缩，同时忽略了平行于坐标轴的弱有效的情形，而 SBM 模型纳入无效率的松弛改进，保证最终的结果是强有效的。</p>
<p><strong>标准 SBM 模型</strong>形式为： 对每个决策单元 <span class="math inline">\(k\)</span>， <span class="math display">\[
\begin{aligned}&amp;\min\rho=\frac{1-\frac{1}{m}\sum_{j=1}^ms_j^-/x_{kj}}{1+\frac{1}{q}\sum_{r=1}^qs_r^-/y_{kj}}\\ \mathbf{s.t.~~}&amp;X\lambda+s^-=x_k\\&amp;Y\lambda-s^{+}=y_{k}\\&amp;\lambda,s^-,s^+\geq0,\quad j=1,\cdots,m;\; r=1,\cdots,q\end{aligned}
\]</span></p>
<p>该模型旨在通过最小化投入的相对减少量和最大化期望产出的相对增加量来衡量效率。目标函数最优解中 <span class="math inline">\(\rho^*\)</span> 表示效率值，该模型同时从投入和产出两个方面考察无效率的表现，故称为非径向模型。</p>
<p>若同时加入非期望产出，则得到<strong>带非期望产出的 SBM 模型</strong>：对每个决策单元 <span class="math inline">\(k\)</span>， <span class="math display">\[
\begin{aligned} &amp; \min \rho = \frac{1 - \frac{1}{m} \sum_{i=1}^m \frac{s_i^-}{x_{ik}}}{1 + \frac{1}{q+b} \left( \sum\limits_{r=1}^q \frac{s_r^g}{y_{rk}^g} + \sum\limits_{t=1}^b \frac{s_t^b}{y_{tk}^b} \right)} \\ \mathbf{s.t.~~}&amp; X\lambda + s^- = x_k \\ &amp; Y^g\lambda - s^g = y_k^g \\ &amp; Y^b\lambda + s^b = y_k^b \\ &amp; \lambda, s^-, s^g, s^b \geq 0, \quad i=1,\ldots,m; r=1,\ldots,q; t=1,\ldots,b \end{aligned}
\]</span> 其中，<span class="math inline">\(m,q,b\)</span> 分别为投入、期望产出、非期望产出的数量；</p>
<p><span class="math inline">\(s^-,s^g,s^b\)</span> 分别为投入、期望产出和非期望产出的松弛变量；</p>
<p><span class="math inline">\(x_k,y_k^g,y_k^b\)</span> 分别为第<span class="math inline">\(k\)</span>个 DMU 的投入、期望产出和非期望产出；</p>
<p><span class="math inline">\(X,Y^g,Y^b\)</span> 分别为投入、期望产出和非期望产出的数据矩阵；</p>
<p><span class="math inline">\(\lambda\)</span> 为权重向量。</p>
</section><section id="超效率模型" class="level3" data-number="11.2.4"><h3 data-number="11.2.4" class="anchored" data-anchor-id="超效率模型">
<span class="header-section-number">11.2.4</span> 超效率模型</h3>
<p>在传统的 DEA 模型中，效率前沿上的决策单元（DMU）都会被赋予效率值 <span class="math inline">\(1\)</span>，这意味着这些单位都被视为“最优”或“有效”的代表。然而，这种设定也带来了一个问题：无法进一步区分这些高效单元之间的相对表现。</p>
<p><strong>超效率模型</strong>正是为了解这一问题而提出的。其核心思想是：将原本处于效率前沿的某个 DMU 从参考集中移除，再评估它在其余 DMU 所构成的新前沿面上的表现。这样做的结果是，原本效率为 <span class="math inline">\(1\)</span> 的 DMU 现在可能会得到一个大于 <span class="math inline">\(1\)</span> 的效率值，从而反映出它在“超越现有最佳实践”时的表现。</p>
<p>换句话说，<strong>超效率模型不是重新评估谁是有效的，而是衡量那些已经被认为是有效的 DMU 之间，谁更胜一筹</strong>。这使得我们可以在不改变原有 DEA 基本框架的前提下，对高效单元进行排序和深入比较，尤其适用于需要甄选标杆或识别领先实践者的场景。</p>
<p>超效率模型在实际应用中非常有用，例如在绩效评估、资源分配、政策制定等方面，帮助决策者识别真正具有引领作用的个体，并据此推广先进经验。</p>
<p>以<strong>投入导向的 BCC（对偶）模型</strong>改写为超效率模型为例：对每个决策单元 <span class="math inline">\(k\)</span>， <span class="math display">\[
\begin{aligned} &amp; \min \theta \\ \text{s.t.} \quad &amp; \sum_{\substack{i=1\\i \neq k}}^n \lambda_i x_{ij} \leq \theta x_{kj}, \quad j = 1, \cdots, m \\ &amp; \sum_{\substack{i=1\\i \neq k}}^n \lambda_i y_{ir} \geq y_{kr}, \quad r = 1, \cdots, q \\ &amp; \sum_{\substack{i=1\\i \neq k}}^n \lambda_i = 1, \\  &amp;\lambda_i \geq 0, \quad i \neq k \end{aligned}
\]</span></p>
<p><code>mathmodels</code> 包对 <code>deaR</code> 包中的相应函数做了封装，提供了四个函数：<code>basic_DEA</code>、<code>super_DEA</code>、<code>basic_SBM</code> 和 <code>super_SBM</code>，分别适用于不同类型的 DEA 或 SBM 模型变体：径向数据包络分析（DEA）模型（Charnes 等，1978；Banker 等，1984）和基于松弛变量测度的 SBM 模型（Tone，2001）计算效率得分提供了简化的操作接口，支持在规模报酬不变（CRS）或规模报酬可变（VRS）条件下，运行标准模型和超效率模型，并可选择性地处理非期望产出。</p>
<p>基本语法为（同其它函数）：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="fu">basic_DEA</span>(data, inputs, outputs, <span class="at">ud_outputs =</span> <span class="cn">NULL</span>,</span>
<span id="cb1-2"><a href="#cb1-2"></a>          <span class="at">orientation =</span> <span class="st">"io"</span>, <span class="at">rts =</span> <span class="st">"vrs"</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>
<code>data</code>：数据框，第 1 列为 DMU 名字；</li>
<li>
<code>inputs/outputs</code>（包含 <code>ud_outputs</code>）：投入、产出的列名或列索引；</li>
<li>
<code>ud_outputs</code>：非期望产出位于产出中的位置索引，默认为 <code>NULL</code>；</li>
<li>
<code>orientation</code>：设置导向：<code>"io"</code>（默认，投入导向）、<code>"oo"</code>（产出导向）；</li>
<li>
<code>rts</code>：设置规模收益：<code>"crs"（不变规模收益）、</code>“vrs”`（默认，可变规模收益）。</li>
</ul></section><section id="malmquist-指数" class="level3" data-number="11.2.5"><h3 data-number="11.2.5" class="anchored" data-anchor-id="malmquist-指数">
<span class="header-section-number">11.2.5</span> Malmquist 指数</h3>
<p><strong>Malmquist 指数</strong> 是一种基于数据包络分析（DEA）框架、用于衡量决策单元（DMU）在不同时期之间<strong>全要素生产率</strong>变化的指标。它通过比较不同时间点的技术前沿，将生产率变化分解为 <strong>技术效率变化（Efficiency Change, EC）</strong> 和 <strong>技术进步（Technical Change, TC）</strong>。</p>
<p>该指数建立在 <strong>Shephard 距离函数</strong> 的基础上，适用于投入导向或产出导向模型。无论选择哪种导向，计算时均采用原始距离函数值，而非人为归一化的“效率得分”。</p>
<section id="shephard-距离函数的定义" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="shephard-距离函数的定义">1. Shephard 距离函数的定义</h4>
<ul>
<li>
<strong>投入导向距离函数</strong> <span class="math inline">\(D_I^t(\mathbf{x},\mathbf{y})\)</span> 表示：在保持产出 <span class="math inline">\(\mathbf{y}\)</span> 不变的前提下，投入向量 <span class="math inline">\(\mathbf{x}\)</span> 可以按比例缩小的最大倍数 <span class="math inline">\(\theta\)</span>，使得 <span class="math inline">\((\theta\mathbf{x}, \mathbf{y})\)</span> 仍属于时期 <span class="math inline">\(t\)</span> 的生产可能集 <span class="math inline">\(P^t\)</span>：</li>
</ul>
<p><span class="math display">\[
D_I^t(\mathbf{x},\mathbf{y}) = \sup\left\{ \theta \geq 0 \mid (\theta\mathbf{x}, \mathbf{y}) \in P^t \right\}
\]</span></p>
<p>此时，<span class="math inline">\(D_I^t \in (0,1]\)</span>，且当 <span class="math inline">\(D_I^t = 1\)</span> 时表示技术有效；<span class="math inline">\(D_I^t &lt; 1\)</span> 表示存在投入冗余。该值即为 DEA 模型求解出的效率值 <span class="math inline">\(\theta^*\)</span>。</p>
<ul>
<li>
<strong>产出导向距离函数</strong> <span class="math inline">\(D_O^t(\mathbf{x},\mathbf{y})\)</span> 表示：在保持投入 <span class="math inline">\(\mathbf{x}\)</span> 不变的前提下，产出向量 <span class="math inline">\(\mathbf{y}\)</span> 可以按比例放大的最大倍数 <span class="math inline">\(\eta\)</span>，使得 <span class="math inline">\((\mathbf{x}, \eta\mathbf{y})\)</span> 仍属于时期 <span class="math inline">\(t\)</span> 的生产可能集 <span class="math inline">\(P^t\)</span>： <span class="math display">\[
D_O^t(\mathbf{x},\mathbf{y}) = \sup\left\{ \eta \geq 0 \mid (\mathbf{x}, \eta\mathbf{y}) \in P^t \right\}
\]</span>
</li>
</ul>
<p>此时，<span class="math inline">\(D_O^t \in [1,\infty)\)</span>，且当 <span class="math inline">\(D_O^t = 1\)</span> 时表示技术有效；<span class="math inline">\(D_O^t &gt; 1\)</span> 表示存在产出不足。</p>
<blockquote class="blockquote">
<p>📌 <strong>注意</strong>：尽管实践中常将产出导向的“效率评分”定义为 <span class="math inline">\(1/D_O^t \in (0,1]\)</span> 以便解释，但在 Malmquist 指数的正式计算中，应直接使用原始的距离函数值 <span class="math inline">\(D_O^t \geq 1\)</span>，以保证理论一致性。</p>
</blockquote>
</section><section id="生产可能集说明" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="生产可能集说明">2. 生产可能集说明</h4>
<p>这里的 <strong>生产可能集</strong> <span class="math inline">\(P^t = \{(\mathbf{x},\mathbf{y}) \mid \mathbf{x} \text{ 可生产 } \mathbf{y}\}\)</span> 是由 DEA 方法构建的技术集合，表示在时期 <span class="math inline">\(t\)</span> 下所有可行的“投入-产出”组合。其边界构成生产前沿。</p>
<ul>
<li>在 <strong>规模报酬不变（CRS）</strong> 假设下，技术集允许自由缩放；</li>
<li>在 <strong>规模报酬可变（VRS）</strong> 假设下，技术集限制了大规模扩张的有效性。</li>
</ul>
<p><strong>注：</strong>单投入单导出的生产可能集（DEA 技术集），就是如前文图示的前沿线（面）及其右下方的区域，可以是规模收益 CRS 或 VRS 假设下。</p>
</section><section id="跨期距离函数的构造" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="跨期距离函数的构造">3. 跨期距离函数的构造</h4>
<p>考虑两个相邻时期 <span class="math inline">\(t\)</span> 和 <span class="math inline">\(t+1\)</span>，我们需要计算以下四个距离函数（统一使用同一导向，例如产出导向）：</p>
<ul>
<li>
<span class="math inline">\(D^t(\mathbf{x}^t, \mathbf{y}^t)\)</span>：用 <span class="math inline">\(t\)</span> 期技术评估 <span class="math inline">\(t\)</span> 期自身表现；</li>
<li>
<span class="math inline">\(D^{t+1}(\mathbf{x}^{t+1}, \mathbf{y}^{t+1})\)</span>：用 <span class="math inline">\(t+1\)</span> 期技术评估 <span class="math inline">\(t+1\)</span> 期自身表现；</li>
<li>
<span class="math inline">\(D^t(\mathbf{x}^{t+1}, \mathbf{y}^{t+1})\)</span>：将 <span class="math inline">\(t+1\)</span> 期的数据投影到 <span class="math inline">\(t\)</span> 期的技术前沿；</li>
<li>
<span class="math inline">\(D^{t+1}(\mathbf{x}^t, \mathbf{y}^t)\)</span>：将 <span class="math inline">\(t\)</span> 期的数据投影到 <span class="math inline">\(t+1\)</span> 期的技术前沿。</li>
</ul>
<p>这些距离函数通过 DEA 模型分别求解，是构建 Malmquist 指数的基础。</p>
</section><section id="参照集的选择" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="参照集的选择">4. 参照集的选择</h4>
<p>Malmquist 指数需要比较不同时期的技术前沿（即生产可能集），因此必须明确：以哪些决策单元作为构建每个时期技术前沿的基础？ 这就是所谓的“参照集”选择问题。</p>
<p>主要有三种构建方式：</p>
<ul>
<li>
<strong>同期参照集</strong>：每个时期的生产可能集仅基于该时期自身的观测数据构建，即各期技术前沿独立估计。距离函数的计算以当期样本为参考基准，不跨期混合数据。</li>
<li>
<strong>序列参照集</strong>：技术前沿随时间逐步累积扩展，后期的技术集包含当前及之前所有时期的数据。由此构建的生产可能集具有非递减性，反映技术演进过程中对历史最佳实践的持续吸收。</li>
<li>
<strong>全局参照集</strong>：将所有时间段的观测数据合并，共同构建一个跨期统一的“全局生产可能集”。该前沿代表整个样本期内的最优技术边界，不随时间变化，为所有时期提供一致的评估基准。</li>
</ul></section><section id="malmquist-指数的定义" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="malmquist-指数的定义">5. Malmquist 指数的定义</h4>
<p><strong>Malmquist 生产率指数</strong>（MI）定义为： <span class="math display">\[
\text{MI}^t = \sqrt{
\frac{D^t(\mathbf{x}^{t+1}, \mathbf{y}^{t+1}) / D^t(\mathbf{x}^t, \mathbf{y}^t)}
     {D^{t+1}(\mathbf{x}^{t+1}, \mathbf{y}^{t+1}) / D^{t+1}(\mathbf{x}^t, \mathbf{y}^t)}
}
\]</span> 其中：</p>
<ul>
<li>若 <span class="math inline">\(\text{MI}^t &gt; 1\)</span>：表示生产率提高；</li>
<li>若 <span class="math inline">\(\text{MI}^t = 1\)</span>：表示生产率不变；</li>
<li>若 <span class="math inline">\(\text{MI}^t &lt; 1\)</span>：表示生产率下降。</li>
</ul></section><section id="crs-与-vrs-假设下的分解差异" class="level4 unnumbered"><h4 class="unnumbered anchored" data-anchor-id="crs-与-vrs-假设下的分解差异">6. CRS 与 VRS 假设下的分解差异</h4>
<p>Malmquist 指数的分解结果会因是否假设 <strong>规模报酬不变（CRS）</strong> 或 <strong>规模报酬可变（VRS）</strong> 而有所不同。</p>
<section id="crs-假设下的-malmquist-分解" class="level5 unnumbered"><h5 class="unnumbered anchored" data-anchor-id="crs-假设下的-malmquist-分解">(1) CRS 假设下的 Malmquist 分解</h5>
<p>在 CRS 下，技术前沿满足线性齐次性，此时 Malmquist 指数仅反映：</p>
<ul>
<li><strong>技术效率变化（EC）</strong></li>
<li><strong>技术进步（TC）</strong></li>
</ul>
<p>没有进一步区分规模效应。</p>
<p>因此，CRS-Malmquist 指数分解为： <span class="math display">\[
\text{MI}_{\text{CRS}}^t = \underbrace{\frac{D_{\text{CRS}}^{t+1}(\mathbf{x}^{t+1}, \mathbf{y}^{t+1})}{D_{\text{CRS}}^t(\mathbf{x}^t, \mathbf{y}^t)}}_{\text{EC}_{\text{CRS}}} \times
\underbrace{\sqrt{ \frac{D_{\text{CRS}}^t(\mathbf{x}^{t+1}, \mathbf{y}^{t+1}) / D_{\text{CRS}}^{t+1}(\mathbf{x}^{t+1}, \mathbf{y}^{t+1})}{D_{\text{CRS}}^t(\mathbf{x}^t, \mathbf{y}^t) / D_{\text{CRS}}^{t+1}(\mathbf{x}^t, \mathbf{y}^t)} }}_{\text{TC}_{\text{CRS}}}
\]</span></p>
<p>此版本捕捉的是“纯技术”层面的变化，但包含了规模效率变动的影响。</p>
</section><section id="vrs-假设下的-malmquist-分解" class="level5 unnumbered"><h5 class="unnumbered anchored" data-anchor-id="vrs-假设下的-malmquist-分解">(2) VRS 假设下的 Malmquist 分解</h5>
<p>在 VRS 下，技术前沿不再允许任意缩放，因此可以剔除规模效率变化的影响，得到 <strong>纯技术效率变化</strong> 和 <strong>纯技术进步</strong>。</p>
<p>VRS-Malmquist 指数为： <span class="math display">\[
\text{MI}_{\text{VRS}}^t = \underbrace{\frac{D_{\text{VRS}}^{t+1}(\mathbf{x}^{t+1}, \mathbf{y}^{t+1})}{D_{\text{VRS}}^t(\mathbf{x}^t, \mathbf{y}^t)}}_{\text{PEC}} \times
\underbrace{\sqrt{ \frac{D_{\text{VRS}}^t(\mathbf{x}^{t+1}, \mathbf{y}^{t+1}) / D_{\text{VRS}}^{t+1}(\mathbf{x}^{t+1}, \mathbf{y}^{t+1})}{D_{\text{VRS}}^t(\mathbf{x}^t, \mathbf{y}^t) / D_{\text{VRS}}^{t+1}(\mathbf{x}^t, \mathbf{y}^t)} }}_{\text{PTC}}
\]</span></p>
<p>其中：</p>
<ul>
<li>
<span class="math inline">\(\text{PEC}\)</span>：Pure Efficiency Change（纯技术效率变化）</li>
<li>
<span class="math inline">\(\text{PTC}\)</span>：Pure Technical Change（纯技术进步）</li>
</ul>
<blockquote class="blockquote">
<p>✅ <strong>关键优势</strong>：VRS 分解排除了规模效率波动的干扰，更适合识别“管理改进”或“技术创新”的真实影响。</p>
</blockquote>
</section><section id="规模效率变化sec的提取" class="level5 unnumbered"><h5 class="unnumbered anchored" data-anchor-id="规模效率变化sec的提取">(3) 规模效率变化（SEC）的提取</h5>
<p>通过 CRS 与 VRS 结果的对比，还可进一步计算 <strong>规模效率变化（SEC）</strong>： <span class="math display">\[
\text{SEC}^t = \frac{\text{EC}_{\text{CRS}}}{\text{PEC}} = \frac{D_{\text{CRS}}^{t+1}/D_{\text{CRS}}^t}{D_{\text{VRS}}^{t+1}/D_{\text{VRS}}^t}
\]</span> 若 <span class="math inline">\(\text{SEC}^t &gt; 1\)</span>：表示规模效率提升（更接近最优规模）；<br>
若 <span class="math inline">\(\text{SEC}^t &lt; 1\)</span>：表示规模效率退化。</p>
<p>最终完整的 TFP 分解为：</p>
<p><span class="math display">\[
\text{MI}^t = \text{PEC} \times \text{PTC} \times \text{SEC}
\]</span></p>
<p>这被称为 <strong>三重分解法</strong>，完整揭示了生产率增长的来源。</p>
<p><code>mathmodels</code> 包提供了 <code>malmquist()</code> 计算跨时期的 Malmquist 指数及其分解，该函数是对 <code>deaR</code> 包中相关函数做了封装，更便于使用。基本语法：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a><span class="fu">malmquist</span>(data, period, inputs, outputs,</span>
<span id="cb2-2"><a href="#cb2-2"></a>          <span class="at">orientation =</span> <span class="st">"oo"</span>, <span class="at">rts =</span> <span class="st">"vrs"</span>,</span>
<span id="cb2-3"><a href="#cb2-3"></a>          <span class="at">type1 =</span> <span class="st">"glob"</span>, <span class="at">type2 =</span> <span class="st">"rd"</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>
<code>data</code>: 长格式数据框，第 1 列为决策单元，包含时期列</li>
<li>
<code>period, inputs, outputs</code>: 时期、投入和产出对应的列索引或列名</li>
<li>
<code>orientation</code>: <code>"io"</code>（投入导向），<code>"oo"</code>（产出导向，默认）</li>
<li>
<code>rts</code>: <code>"vrs"</code>（可变规模报酬，默认），<code>"crs"</code>（不变规模报酬）</li>
<li>
<code>type1</code>: 参照集：<code>"cont"</code>（当期），<code>"seq"</code>（序列）或 <code>"glob"</code>（全局，默认）</li>
<li>
<code>type2</code>: 分解方法：<code>"fgnz"</code>（Färe 等，1994），<code>"rd"</code>（Ray 和 Desli，1997，默认），<code>"gl"</code>（广义 Malmquist）或 <code>"bias"</code>（偏向性技术变化）</li>
</ul>
<p>返回包含 Period、DMU、Malmquist 指数、EC（效率变化）、TC（技术变化）、PECH（纯效率变化）和 SECH（规模效率变化）的数据框。</p>
</section></section></section></section><section id="dea-案例" class="level2" data-number="11.3"><h2 data-number="11.3" class="anchored" data-anchor-id="dea-案例">
<span class="header-section-number">11.3</span> DEA 案例</h2>
<p>加载包：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="fu">library</span>(mathmodels)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p><strong>案例数据：</strong>2011 年各省（市、自治区）医院的部分投入和产出指标。以床位数和卫生技术人员数作为投入，以诊疗人次数和入院人数作为产出，（可选）医疗废弃物作为非期望产出。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>df <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/hospital.csv"</span>)</span>
<span id="cb4-2"><a href="#cb4-2"></a>df</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 6
   DMU   `床位数(万个)` `卫技人员数(万个)` `诊疗人次数(万人次)` `入院人数(万人)`
   &lt;chr&gt;          &lt;dbl&gt;              &lt;dbl&gt;                &lt;dbl&gt;            &lt;dbl&gt;
 1 安徽           14.1               13.3                 6334.            439. 
 2 北京            8.76              12.9                10434.            188. 
 3 福建            8.99               9.39                7206.            309. 
 4 甘肃            6.67               5.31                2772.            171. 
 5 广东           24.6               28.9                29378.            799. 
 6 广西           95.8               10.6                 6445.            326. 
 7 贵州            7.84               6.93                2911.            243. 
 8 海南            2.14               2.63                1269.             61.2
 9 河北           18.8               18.4                 8249.            568. 
10 河南           24.0               23.1                11408.            704. 
# ℹ 21 more rows
# ℹ 1 more variable: `医疗废弃物(万套)` &lt;dbl&gt;</code></pre>
</div>
</div>
<p>先以投入导向、VRS 假设下的 DEA 模型（BCC）为例，不考虑非期望产出：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a>bbc_in <span class="ot">=</span> <span class="fu">basic_DEA</span>(df, <span class="at">inputs =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">outputs =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb6-2"><a href="#cb6-2"></a>                   <span class="at">orientation =</span> <span class="st">"io"</span>, <span class="at">rts =</span> <span class="st">"vrs"</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>查看各 DMU 效率值</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a>bbc_in<span class="sc">$</span>efficiencies</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     安徽      北京      福建      甘肃      广东      广西      贵州      海南 
0.9548803 0.9184863 1.0000000 0.8550507 1.0000000 0.7966680 0.9708290 0.9414552 
     河北      河南    黑龙江      湖北      湖南      吉林      江苏      江西 
0.9390585 0.9615116 0.6900295 0.9703535 1.0000000 0.7418425 0.9602820 1.0000000 
     辽宁    内蒙古      宁夏      青海      山东      山西      陕西      上海 
0.7314317 0.7214879 0.9100736 0.9074069 1.0000000 0.6190050 0.8281242 1.0000000 
     四川      天津      西藏      新疆      云南      浙江      重庆 
1.0000000 1.0000000 1.0000000 1.0000000 1.0000000 0.9505551 0.8922566 </code></pre>
</div>
</div>
<ul>
<li>
<code>bbc_in</code> 对象中还包含其它结果（略）：</li>
</ul>
<div class="cell">
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>bbc_in<span class="sc">$</span>slacks      <span class="co"># 松弛变量</span></span>
<span id="cb9-2"><a href="#cb9-2"></a>bbc_in<span class="sc">$</span>lambdas     <span class="co"># 权重</span></span>
<span id="cb9-3"><a href="#cb9-3"></a>bbc_in<span class="sc">$</span>targets     <span class="co"># 目标值</span></span>
<span id="cb9-4"><a href="#cb9-4"></a>bbc_in<span class="sc">$</span>references  <span class="co"># 参照单元</span></span>
<span id="cb9-5"><a href="#cb9-5"></a>bbc_in<span class="sc">$</span>returns     <span class="co"># 规模收益</span></span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>
<p><strong>松弛变量（<span class="math inline">\(\mathbf{s}\)</span>）：</strong>衡量投入过度或产出不足的程度，反映决策单元在哪些方面可以进一步优化：</p>
<ul>
<li>投入松弛 = 实际投入 - 目标投入</li>
<li>产出松弛 = 目标产出 - 实际产出</li>
</ul>
</li>
<li>
<p><strong>权重（<span class="math inline">\(\mathbf{\lambda}\)</span>）：</strong>表示参考单元的权重，用于构建效率前沿；每个 DMU 的效率值由其参考单元的线性组合计算：</p>
<ul>
<li>对于非有效 DMU（效率值 <span class="math inline">\(&lt; 1\)</span>），<span class="math inline">\(\lambda\)</span> 表示它应该向哪些有效 DMU（效率值 <span class="math inline">\(= 1\)</span>）学习，<span class="math inline">\(\lambda &gt; 0\)</span> 的 DMU 是其参考单元</li>
</ul>
</li>
<li>
<p><strong>目标值：</strong> DMU 达到 DEA 有效时应有的投入和产出水平；对非有效 DMU，目标值 = 参考单元的加权组合：</p>
<ul>
<li>投入目标 = 实际投入 - 投入松弛</li>
<li>产出目标 = 实际产出 + 产出松弛</li>
</ul>
</li>
<li><p><strong>参照单元：</strong>效率前沿上的 DMU，非有效 DMU 通过模仿它们来提高效率；<span class="math inline">\(\lambda &gt; 0\)</span> 的 DMU。</p></li>
<li>
<p><strong>规模收益：</strong>表示 DMU 的规模效率，基于 VRS 模型的 <span class="math inline">\(\lambda\)</span> 值之和：</p>
<ul>
<li>irs（<span class="math inline">\(\sum \lambda &lt; 1\)</span>）：规模报酬递增（扩大规模可提升效率）</li>
<li>drs（<span class="math inline">\(\sum \lambda &gt; 1\)</span>）：规模报酬递减（规模过大导致效率下降）</li>
<li>crs（<span class="math inline">\(\sum \lambda = 1\)</span>）：规模报酬不变（最优规模）</li>
</ul>
</li>
</ul>
<p>若计算同样设置下的超效率：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>res <span class="ot">=</span> <span class="fu">super_DEA</span>(df, <span class="at">inputs =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">outputs =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb10-2"><a href="#cb10-2"></a>                <span class="at">orientation =</span> <span class="st">"io"</span>, <span class="at">rts =</span> <span class="st">"vrs"</span>)</span>
<span id="cb10-3"><a href="#cb10-3"></a>res<span class="sc">$</span>efficiencies</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     安徽      北京      福建      甘肃      广东      广西      贵州      海南 
0.9548803 0.9184863 1.0518247 0.8550507        NA 0.7966680 0.9708290 0.9414552 
     河北      河南    黑龙江      湖北      湖南      吉林      江苏      江西 
0.9390585 0.9615116 0.6900295 0.9703535 1.0368439 0.7418425 0.9602820 1.0036738 
     辽宁    内蒙古      宁夏      青海      山东      山西      陕西      上海 
0.7314317 0.7214879 0.9100736 0.9074069        NA 0.6190050 0.8281242 1.1885921 
     四川      天津      西藏      新疆      云南      浙江      重庆 
1.0446519 1.0295240 2.9436174 1.0114148 1.1956914 0.9505551 0.8922566 </code></pre>
</div>
</div>
<p>注意，有些 DMU 的超效率为 <code>NA</code>，对应其线性规划模型无可行解，一种处理办法是将其替换为标准 DEA 效率值：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a>idx <span class="ot">=</span> <span class="fu">is.na</span>(res<span class="sc">$</span>efficiencies)</span>
<span id="cb12-2"><a href="#cb12-2"></a>res<span class="sc">$</span>efficiencies[idx] <span class="ot">=</span> bbc_in<span class="sc">$</span>efficiencies[idx]</span>
<span id="cb12-3"><a href="#cb12-3"></a>res<span class="sc">$</span>efficiencies</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>     安徽      北京      福建      甘肃      广东      广西      贵州      海南 
0.9548803 0.9184863 1.0518247 0.8550507 1.0000000 0.7966680 0.9708290 0.9414552 
     河北      河南    黑龙江      湖北      湖南      吉林      江苏      江西 
0.9390585 0.9615116 0.6900295 0.9703535 1.0368439 0.7418425 0.9602820 1.0036738 
     辽宁    内蒙古      宁夏      青海      山东      山西      陕西      上海 
0.7314317 0.7214879 0.9100736 0.9074069 1.0000000 0.6190050 0.8281242 1.1885921 
     四川      天津      西藏      新疆      云南      浙江      重庆 
1.0446519 1.0295240 2.9436174 1.0114148 1.1956914 0.9505551 0.8922566 </code></pre>
</div>
</div>
<p>最后，再计算另外四种 DEA 效率：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a>ccr_in <span class="ot">=</span> <span class="fu">basic_DEA</span>(df, <span class="at">inputs =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">outputs =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb14-2"><a href="#cb14-2"></a>                   <span class="at">orientation =</span> <span class="st">"io"</span>, <span class="at">rts =</span> <span class="st">"crs"</span>)</span>
<span id="cb14-3"><a href="#cb14-3"></a>ccr_out <span class="ot">=</span> <span class="fu">basic_DEA</span>(df, <span class="at">inputs =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">outputs =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb14-4"><a href="#cb14-4"></a>                   <span class="at">orientation =</span> <span class="st">"oo"</span>, <span class="at">rts =</span> <span class="st">"crs"</span>)</span>
<span id="cb14-5"><a href="#cb14-5"></a>bbc_out <span class="ot">=</span> <span class="fu">basic_DEA</span>(df, <span class="at">inputs =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">outputs =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">5</span>, </span>
<span id="cb14-6"><a href="#cb14-6"></a>                   <span class="at">orientation =</span> <span class="st">"oo"</span>, <span class="at">rts =</span> <span class="st">"vrs"</span>)</span>
<span id="cb14-7"><a href="#cb14-7"></a>sbm_ud_out <span class="ot">=</span> <span class="fu">basic_SBM</span>(df, <span class="at">inputs =</span> <span class="dv">2</span><span class="sc">:</span><span class="dv">3</span>, <span class="at">outputs =</span> <span class="dv">4</span><span class="sc">:</span><span class="dv">6</span>, <span class="at">ud_outputs =</span> <span class="dv">3</span>,</span>
<span id="cb14-8"><a href="#cb14-8"></a>                       <span class="at">orientation =</span> <span class="st">"oo"</span>, <span class="at">rts =</span> <span class="st">"vrs"</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>合并结果，并计算规模效率（CRS 效率 = VRS 效率 * 规模效率）：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="fu">tibble</span>(<span class="at">DMU =</span> df<span class="sc">$</span>DMU, <span class="at">ccr_in =</span> ccr_in<span class="sc">$</span>efficiencies, </span>
<span id="cb15-2"><a href="#cb15-2"></a>       <span class="at">ccr_out =</span> ccr_out<span class="sc">$</span>efficiencies, </span>
<span id="cb15-3"><a href="#cb15-3"></a>       <span class="at">bbc_in =</span> bbc_in<span class="sc">$</span>efficiencies, </span>
<span id="cb15-4"><a href="#cb15-4"></a>       <span class="at">bbc_out =</span> bbc_out<span class="sc">$</span>efficiencies, </span>
<span id="cb15-5"><a href="#cb15-5"></a>       <span class="at">sbm_ud_out =</span> sbm_ud_out<span class="sc">$</span>efficiencies,</span>
<span id="cb15-6"><a href="#cb15-6"></a>       <span class="at">scale_eff =</span> ccr_in <span class="sc">/</span> bbc_in)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 31 × 7
   DMU   ccr_in ccr_out bbc_in bbc_out sbm_ud_out scale_eff
   &lt;chr&gt;  &lt;dbl&gt;   &lt;dbl&gt;  &lt;dbl&gt;   &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;
 1 安徽   0.944   0.944  0.955   0.957      0.690     0.989
 2 北京   0.917   0.917  0.918   0.917      0.839     0.999
 3 福建   1.00    1      1.00    1          1.000     1.000
 4 甘肃   0.834   0.834  0.855   0.849      1         0.975
 5 广东   1.000   1      1.00    1          1.000     1.000
 6 广西   0.795   0.795  0.797   0.802      0.847     0.998
 7 贵州   0.963   0.963  0.971   0.970      0.728     0.992
 8 海南   0.833   0.833  0.941   0.932      0.771     0.885
 9 河北   0.904   0.904  0.939   0.945      0.619     0.963
10 河南   0.883   0.883  0.962   0.970      0.841     0.918
# ℹ 21 more rows</code></pre>
</div>
</div>
</section><section id="dea-malmquist-案例" class="level2" data-number="11.4"><h2 data-number="11.4" class="anchored" data-anchor-id="dea-malmquist-案例">
<span class="header-section-number">11.4</span> DEA-malmquist 案例</h2>
<p>来自 <code>deaR</code> 包的 2005-2009 年中国各省份工业经济数据（长格式），共 155 行、5 列，包含决策单元（各省份）、年份，以及</p>
<p>投入指标：</p>
<ul>
<li>
<code>Capital</code>：总资产（亿元）；</li>
<li>
<code>Labor</code>：年平均从业人员（万人）。</li>
</ul>
<p>产出指标 ：</p>
<ul>
<li>
<code>GIOV</code>：工业总产值（亿元）。</li>
</ul>
<p>该数据集可评估中国工业部门在“十一五”期间的生产效率变化、技术进步与规模效益。数据结构清晰，适合进行跨期、跨区域的效率比较分析。</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a>dat <span class="ot">=</span> <span class="fu">read_csv</span>(<span class="st">"data/economy.csv"</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a>dat</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 155 × 5
   DMUs         Period Capital Labor   GIOV
   &lt;chr&gt;         &lt;dbl&gt;   &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt;
 1 Beijing        2005  12830. 117.   6946.
 2 Tianjin        2005   6348. 122.   6774.
 3 Hebei          2005   9474. 292.  11008.
 4 Shanxi_1       2005   7045. 213.   4851.
 5 Neimenggu      2005   4596.  83.7  2996.
 6 Liaoning       2005  11902. 277.  10815.
 7 Jilin          2005   4507. 102.   3792.
 8 Heilongjiang   2005   5174. 137.   4715.
 9 Shangai        2005  15906. 260.  15768.
10 Jiangsu        2005  25489. 704.  32707.
# ℹ 145 more rows</code></pre>
</div>
</div>
<p>调用 <code>malmquist()</code> 函数计算 <code>Malmquist</code> 指数及其分解，需要提供长格式数据框，设置日期、投入、产出列，可选提供导向、规模收益假设、参照集、计算方法：</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode numberSource r number-lines code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="fu">malmquist</span>(dat, <span class="at">period =</span> <span class="dv">2</span>, <span class="at">inputs =</span> <span class="dv">3</span><span class="sc">:</span><span class="dv">4</span>, <span class="at">outputs =</span> <span class="dv">5</span>,</span>
<span id="cb19-2"><a href="#cb19-2"></a>          <span class="at">orientation =</span> <span class="st">"oo"</span>, <span class="at">rts =</span> <span class="st">"vrs"</span>,</span>
<span id="cb19-3"><a href="#cb19-3"></a>          <span class="at">type1 =</span> <span class="st">"glob"</span>, <span class="at">type2 =</span> <span class="st">"rd"</span>)</span></code><button title="复制到剪贴板" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 124 × 7
   Period    DMU             mi    ec    tc  pech  sech
   &lt;chr&gt;     &lt;chr&gt;        &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;
 1 2005~2006 Beijing      1.18  0.970  1.22 0.970 1.00 
 2 2005~2006 Tianjin      1.22  0.993  1.23 1.00  0.993
 3 2005~2006 Hebei        1.03  0.979  1.05 0.977 1.00 
 4 2005~2006 Shanxi_1     0.969 0.939  1.03 0.935 1.00 
 5 2005~2006 Neimenggu    1.20  0.987  1.22 0.990 0.997
 6 2005~2006 Liaoning     1.13  1.01   1.11 1.01  1.000
 7 2005~2006 Jilin        1.10  0.956  1.15 0.950 1.01 
 8 2005~2006 Heilongjiang 1.05  0.966  1.09 0.963 1.00 
 9 2005~2006 Shangai      1.12  0.990  1.13 1.00  0.990
10 2005~2006 Jiangsu      0.942 0.891  1.06 1     0.891
# ℹ 114 more rows</code></pre>
</div>
</div>
<p><code>mi</code> 为 Malmquist 指数，<code>ec</code> 为技术效率变化，<code>tc</code> 为技术进步，<code>pech</code> 为纯技术效率变化，<code>sech</code> 为规模效率变化。</p>
<p>更多的 DEA 模型还有：考虑环境因素和随机噪声对决策单元效率影响的三阶段 DEA 模型；固定前沿生产函数的参数法随机前沿模型；以及以效率为因变量研究效率的影响因素的 Tobit 回归模型。</p>


</section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "已复制");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "已复制");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./fuzzy-eval.html" class="pagination-link" aria-label="模糊综合评价">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">模糊综合评价</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./inequality.html" class="pagination-link" aria-label="不平等度量">
        <span class="nav-page-text"><span class="chapter-number">12</span>&nbsp; <span class="chapter-title">不平等度量</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->



</body></html>